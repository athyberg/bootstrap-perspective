/*! bootstrap-perspective 2016-07-18 */
!function(a){var b=function(){if(0!==a(".perspective").length){var b=this;a(window).on("resize",function(){a("dd").each(function(){b.viewResize(a(this))})}),this.layout()}};b.prototype.layout=function(){a(".slot-single > dd").prepend('<div class="content single-content">'),a(".slot-single > dd > .single-content").each(function(){a(this).append(a(this).siblings(".view:first"))}),a(".slot-tab > dd").each(function(){var b=a(this).children();1===b.length&&b.addClass("active")}),a(".slot-tab > dd").prepend('<ul class="nav nav-tabs">'),a(".slot-tab > dd > .view").each(function(){a(this).asTab(a(this).siblings(".nav-tabs"))}),a(".slot-tab > dd > ul.nav.nav-tabs").after('<div class="content tab-content">'),a(".slot-tab > dd > .tab-content").each(function(){a(this).append(a(this).siblings(".view"))}),a(".slot-tab > dd > ul.nav.nav-tabs").prepend('<li class="dropdown dropdown-tabs hide pull-right"><a class="dropdown-toggle" data-toggle="dropdown" href="#"><b class="caret"></b></a><ul class="dropdown-menu"></ul></li>'),a(".slot-tab[fade]").find(".view").addClass("fade"),a(".slot-tab[fade]").find(".view.active").addClass("in"),a(".slot-tray > dd").prepend('<div class="content tray-content">'),a(".slot-tray > dd > .tray-content").each(function(){a(this).append(a(this).siblings(".view"))});var b=1e3;a(".slot:not(.slot-split)").each(function(){a(this).attr("id","slot-"+b++)}),a('<div class="contextmenu"></div>').appendTo("body"),a(".slot-split:not(.fixed) .slot:not(:first-child) > dd").after('<dt class="draghandle">'),a(".draghandle").draggable();var c=this.handleDragStart,d=this.handleDragging,e=this.handleDragStop;a(".slot-split-horizontal > dd > .slot > .draghandle").each(function(b,f){var g=a(f).parents(".slot-split-horizontal");a(f).draggable({axis:"x",containment:g,start:c,drag:d,stop:e})}),a(".slot-split-vertical > dd > .slot > .draghandle").each(function(b,f){var g=a(f).parents(".slot-split-vertical");a(f).draggable({axis:"y",containment:g,start:c,drag:d,stop:e})}),$tabSlots=a(".slot-tab"),$ctxMenu=a(".contextmenu"),$tabSlots.find(".nav-tabs").droppable({drop:function(b,c){var d=a(c.draggable).find(".view"),e=a(this).siblings(".content");d.addClass("active"),a(this).find("li").removeClass("active"),e.children(".view").removeClass("active"),e.children(".view").removeClass("in"),d.asTab(a(this)),e.append(d),d.trigger("tab-attach",[e]),$tabSlots.filter(".over[fade]").find(".view").addClass("fade"),$tabSlots.filter(".over[fade]").find(".view.active").addClass("in"),a(c.draggable).remove()},tolerance:"pointer",accept:".dialog",activeClass:"accepting",hoverClass:"accepting-hover"}).sortable({delay:500,axis:"x",stop:function(b,c){a(c.item).css("top",""),a(c.item).css("left","")}}),setInterval(function(){a(".view").each(function(){a('[href="#'+a(this).attr("id")+'"]').text(a(this).attr("name"))})},1e3)},b.prototype.viewResize=function(a){var b=a.children(".nav-tabs");b.children("li.dropdown-tabs").first().removeClass("hide");var c=b.find("li.dropdown-tabs .dropdown-menu").first();b.append(c.children()),b.children("li:not(.dropdown-tabs)").each(function(){this.offsetTop>15&&c.append(this)}),c.find(".active").length>0?b.children("li.dropdown-tabs").first().addClass("active"):b.children("li.dropdown-tabs").first().removeClass("active"),0===c.children().length&&b.children("li.dropdown-tabs").first().addClass("hide");var d=b.first().outerHeight()||0;a.find(".view").trigger("view-resize",[a.outerHeight()-d,a.outerWidth()])};var c,d;b.prototype.handleDragStart=function(a,b){c=parseInt(b.offset.left),d=parseInt(b.offset.top)},b.prototype.handleDragging=function(a,b){},b.prototype.handleDragStop=function(b,d){var e,g,h,i,j,k,l=a(d.helper).parent().parent(),m=l.children(".slot"),n=m.has(a(d.helper)),o=n.prev(),p=parseInt(d.offset.left)-c===0;p?(j=d.helper.outerHeight(),k=l.outerHeight(),h=d.offset.top,i=l.offset().top):(j=d.helper.outerWidth(),k=l.outerWidth(),h=d.offset.left,i=l.offset().left);var q=0,r=0;m.each(function(){var b,c=a(this);b=p?c.outerHeight():c.outerWidth(),c.is(n)||c.is(o)||!c.nextAll().is(o)?c.is(n)||c.is(o)||(r+=b):q+=b,c.css("flex-basis",b)}),e=parseInt(h)-i+j/2-q,g=k-e-q-r,a(d.helper).css("top",""),a(d.helper).css("left",""),n.css("flex-basis",g),o.css("flex-basis",e),l.find(".slot:not(.slot-split) dd").each(function(){f.viewResize(a(this))}),setTimeout(function(){var b={layout:[]};a('.slot[id][style*="flex"]').each(function(){b.layout.push({id:a(this).attr("id"),style:a(this).attr("style")})}),a(".perspective").trigger("layout-change",[b])},100)},a.fn.appendView=function(){a(this).appendTo("body"),this.focus()};var e=1e3;a.fn.dialog=function(b,c){var d=a(this),f=a('<div id="dialog-"'+e+'" class="dialog" tabindex="-1" role="dialog"><div class="panel-dialog"><div class="panel panel-default"></div></div></div>'),g=a('<div class="panel-heading"><button type="button" class="close" data-dismiss="dialog" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="dialog-title" href="#'+d.attr("id")+'">'+d.attr("name")+"</h4></div>"),h=a('<div class="panel-body">').append(d);return f.find(".panel").append(g).append(h),g.find(".close").on("mousedown",function(){d.trigger("dialog-close",[f])}),f.on("mousedown",function(){f.appendView()}),f.draggable({start:function(){f.appendView()},opacity:.75,handle:".panel-heading",containment:a(".perspective")}),e++,d.trigger("view-resize",[d.height()]),f},a.fn.showView=function(b,c){var d=a(this);d.css("top",0),d.css("left",-9999),d.appendView();var e=a(window).height(),f=100*d.height()/e;f>100&&(f=.85*e,d.css("height",f)),d.css("top",b||(a(window).height()-d.height())/2),d.css("left",c||(a(window).width()-d.width())/2),d.addClass("raised")},a.fn.asTab=function(b){var c=a(this),d=c.hasClass("active")?"active":"",e=c.attr("id"),f=c.attr("name"),g=a('<li class="'+d+'"><a data-toggle="tab" href="#'+e+'">'+f+"</a></li>");a(b).append(g),c.addClass("tab-pane"),g.on("shown.bs.tab",function(a){c.trigger("view-active",[g])}),g.on("contextmenu",function(b){if("undefined"==typeof window.orientation){b.preventDefault();var d=a('<button type="button" class="btn btn-danger btn-lg" aria-label="Close"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></button>'),e=a('<button type="button" class="btn btn-default btn-lg" aria-label="Detach"><span class="glyphicon glyphicon-new-window" aria-hidden="true"></span></button>');$ctxMenu.children().remove(),$ctxMenu.append(e).append(d),$ctxMenu.css({top:b.pageY+"px",left:b.pageX+"px",display:"inline-block"}).appendView(),d.on("click",function(a){c.trigger("tab-close",[g,a.pageY,a.pageX])}),e.on("click",function(a){c.trigger("tab-detach",[g,a.pageY,a.pageX])}),a(document).on("click",function(a){$ctxMenu.css({display:"none"}),$ctxMenu.children().remove()})}})};var f=new b}(window.jQuery);