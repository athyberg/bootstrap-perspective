/*! bootstrap-perspective 2016-08-19 */
!function(a){var b=function(){if(0!==a(".perspective").length){a(window).on("resize",function(){f.setOrientation(),a("dd").each(function(){f.viewResize(a(this))})}),this.layout()}};b.prototype.layout=function(){this.setOrientation(),this.isMobile()&&a(":root").attr("mobile"),a(".slot-single > dd").prepend('<div class="content single-content">'),a(".slot-single > dd > .single-content").each(function(){a(this).append(a(this).siblings(".view:first"))}),a(".slot-tab > dd").each(function(){var b=a(this).children();1===b.length&&b.addClass("active")}),a(".slot-tab > dd").prepend('<ul class="nav nav-tabs">'),a(".slot-tab > dd > .view").each(function(){a(this).asTab(a(this).siblings(".nav-tabs"))}),a(".slot-tab > dd > ul.nav.nav-tabs").after('<div class="content tab-content">'),a(".slot-tab > dd > .tab-content").each(function(){a(this).append(a(this).siblings(".view"))}),a(".slot-tab > dd > ul.nav.nav-tabs").prepend('<li class="dropdown dropdown-tabs hide pull-right"><a class="dropdown-toggle" data-toggle="dropdown" href="#"><b class="caret"></b></a><ul class="dropdown-menu"></ul></li>'),a(".slot-tab[fade]").find(".view").addClass("fade"),a(".slot-tab[fade]").find(".view.active").addClass("in"),a(".slot-tray > dd").prepend('<div class="content tray-content">'),a(".slot-tray > dd > .tray-content").each(function(){a(this).append(a(this).siblings(".view"))});var b=1e3;a(".slot:not(.slot-split)").each(function(){a(this).attr("id","slot-"+b++)}),a('<div class="contextmenu"></div>').appendTo("body"),a(".slot-split:not(.fixed) .slot:not(:first-child) > dd").after('<dt class="draghandle">'),a(".draghandle").draggable();var c=this.handleDragStart,d=this.handleDragging,e=this.handleDragStop;a(".slot-split-horizontal > dd > .slot > .draghandle").each(function(b,f){var g=a(f).parents(".slot-split-horizontal");a(f).draggable({axis:"x",containment:g,start:c,drag:d,stop:e})}),a(".slot-split-vertical > dd > .slot > .draghandle").each(function(b,f){var g=a(f).parents(".slot-split-vertical");a(f).draggable({axis:"y",containment:g,start:c,drag:d,stop:e})}),$tabSlots=a(".slot-tab"),$ctxMenu=a(".contextmenu"),$tabSlots.find(".nav-tabs").droppable({drop:function(b,c){var d=a(c.draggable).find(".view"),e=a(this).siblings(".content");d.addClass("active"),a(this).find("li").removeClass("active"),e.children(".view").removeClass("active"),e.children(".view").removeClass("in"),d.asTab(a(this)),e.append(d),d.trigger("tab-attach",[e]),$tabSlots.filter(".over[fade]").find(".view").addClass("fade"),$tabSlots.filter(".over[fade]").find(".view.active").addClass("in"),a(c.draggable).remove()},tolerance:"pointer",accept:".dialog",activeClass:"accepting",hoverClass:"accepting-hover"}).sortable({delay:500,axis:"x",stop:function(b,c){a(c.item).css("top",""),a(c.item).css("left","")}}),setInterval(function(){a(".view").each(function(){a('[href="#'+a(this).attr("id")+'"]').text(a(this).attr("name"))})},1e3)},b.prototype.viewResize=function(a){var b=a.children(".nav-tabs");b.children("li.dropdown-tabs").first().removeClass("hide");var c=b.find("li.dropdown-tabs .dropdown-menu").first();b.append(c.children()),b.children("li:not(.dropdown-tabs)").each(function(){this.offsetTop>15&&c.append(this)}),c.find(".active").length>0?b.children("li.dropdown-tabs").first().addClass("active"):b.children("li.dropdown-tabs").first().removeClass("active"),0===c.children().length&&b.children("li.dropdown-tabs").first().addClass("hide");var d=b.first().outerHeight()||0;a.find(".view").trigger("view-resize",[a.outerHeight()-d,a.outerWidth()])},b.prototype.appendView=function(b){a(b).appendTo("body"),b.focus()},b.prototype.setOrientation=function(){a(".perspective").attr("orientation",window.innerHeight>window.innerWidth?"portrait":"landscape")},b.prototype.isMobile=function(){var a=/Android|webOS|iPhone|iPad|iPod|BlackBerry/i.test(navigator.userAgent);return a=a||/iPhone|iPad|iPod/i.test(navigator.platform),a=a||"undefined"!=typeof window.orientation},b.prototype.getTop=function(b,c){if("undefined"!=typeof c){var d=a(window).height()-c-b.height();return d<0?c+d:c}return c},b.prototype.getLeft=function(b,c){if("undefined"!=typeof c){var d=a(window).width()-c-b.width();return d<0?c+d:c}return c},b.prototype.showDialog=function(b,c,d){b.css("top",0),b.css("left",-9999),f.appendView(b);var e=a(window).height(),g=100*b.height()/e;g>100&&(g=.85*e,b.css("height",g)),b.css("top",f.getTop(b,c)||(a(window).height()-b.height())/2),b.css("left",f.getLeft(b,d)||(a(window).width()-b.width())/2),b.addClass("raised")};var c,d;b.prototype.handleDragStart=function(a,b){c=parseInt(b.offset.left),d=parseInt(b.offset.top)},b.prototype.handleDragging=function(a,b){},b.prototype.handleDragStop=function(b,d){var e,g,h,i,j,k,l=a(d.helper).parent().parent(),m=l.children(".slot"),n=m.has(a(d.helper)),o=n.prev(),p=parseInt(d.offset.left)-c===0;p?(j=d.helper.outerHeight(),k=l.outerHeight(),h=d.offset.top,i=l.offset().top):(j=d.helper.outerWidth(),k=l.outerWidth(),h=d.offset.left,i=l.offset().left);var q=0,r=0;m.each(function(){var b,c=a(this);b=p?c.outerHeight():c.outerWidth(),c.is(n)||c.is(o)||!c.nextAll().is(o)?c.is(n)||c.is(o)||(r+=b):q+=b,c.css("flex-basis",b)}),e=parseInt(h)-i+j/2-q,g=k-e-q-r,a(d.helper).css("top",""),a(d.helper).css("left",""),n.css("flex-basis",g),o.css("flex-basis",e),l.find(".slot:not(.slot-split) dd").each(function(){f.viewResize(a(this))}),setTimeout(function(){var b={layout:[]};a('.slot[id][style*="flex"]').each(function(){b.layout.push({id:a(this).attr("id"),style:a(this).attr("style")})}),a(".perspective").trigger("layout-change",[b])},100)};var e=1e3;a.fn.asDialog=function(b,c){var d=a(this),g=a('<div id="dialog-"'+e+'" class="dialog" tabindex="-1" role="dialog"><div class="panel-dialog"><div class="panel panel-default"></div></div></div>'),h=a('<div class="panel-heading"><button type="button" class="close" data-dismiss="dialog" aria-label="Close"><span aria-hidden="true">&times;</span></button><h4 class="dialog-title" href="#'+d.attr("id")+'">'+d.attr("name")+"</h4></div>"),i=a('<div class="panel-body">').append(d);return g.find(".panel").append(h).append(i),h.find(".close").on("mousedown",function(){d.trigger("view-close",[g])}),g.on("mousedown",function(){f.appendView(g),d.trigger("view-active",[g])}),g.draggable({start:function(){f.appendView(g)},opacity:.75,handle:".panel-heading",containment:a(".perspective")}),e++,d.trigger("view-resize",[d.height(),d.width()]),g.type="dialog",f.showDialog(g,b,c),g},a.fn.asTab=function(b){var c=a(this),d=c.hasClass("active")?"active":"",e=c.attr("id"),g=c.attr("name"),h=a('<li class="'+d+'"><a data-toggle="tab" href="#'+e+'">'+g+"</a></li>");a(b).append(h),c.addClass("tab-pane"),h.on("shown.bs.tab",function(a){c.trigger("view-active",[h])}),h.on("contextmenu",function(b){if(!f.isMobile()){b.preventDefault();var d=a('<button type="button" class="btn btn-danger btn-lg" aria-label="Close"><span class="glyphicon glyphicon-remove" aria-hidden="true"></span></button>'),e=a('<button type="button" class="btn btn-default btn-lg" aria-label="Detach"><span class="glyphicon glyphicon-new-window" aria-hidden="true"></span></button>');$ctxMenu.children().remove(),$ctxMenu.append(e).append(d);var g=f.getTop($ctxMenu,b.pageY),i=f.getLeft($ctxMenu,b.pageX);$ctxMenu.css({top:g+"px",left:i+"px",display:"inline-block"}),f.appendView($ctxMenu),d.on("click",function(a){c.trigger("view-close",[h,a.pageY,a.pageX])}),e.on("click",function(a){c.trigger("view-detach",[h,a.pageY,a.pageX])}),a(document).on("click",function(a){$ctxMenu.css({display:"none"}),$ctxMenu.children().remove()})}}),h.type="tab"};var f=new b}(window.jQuery);